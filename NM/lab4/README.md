## Практическое задание №4

Выполнил: Веселый Д. А.

Группа: пми-32

Вариант: 7

### **Цель**:

Сформировать практические навыки применения схем численного интегрирования при использовании квадратурных формул интерполяционного типа, квадратур Гаусса и квадратур для вычисления интегралов специального вида.

### **Формулировка задания.**

1. Задайте на отрезке $[a, b]$ епрерывную неполиномиальную функцию $\phi(x)$.
2. Вычислить $\int_a^b \phi(x) dx$ с точностью $\epsilon = 0.01$. Обосновать выбор схемы интегрирования. Оценить абсолютную погрешность результата.
3. С помощью AI-ассистента DeepSeek решите предыдущую задачу. Какие явные недостатки можно обнаружить?  
*Промт*. Оптимальный метод численного интегрирования Int{exp(x)}dx x in [0,1] с точностью 0.01?
4. На множестве $\R$ задайте всюду непрерывную функцию $\psi(x)$.
5. Вычислить $\int_{-\infty}^{\infty} \psi(x)e^{-x^2} dx$. Использовать квадратуру максимальной точности с $N$ узлами интегрирования. Оценить абсолютную погрешность результата. 
### Исходные данные

|№ варианта|a|b|N|
|---|---|---|---|
|7|-0.09|0.77|3|

### Задания 1-2: интегрирование на отрезке
Пусть $\phi(x) = \cos(x)$, из варианта $h = b - a = 0.86$, $\sigma_0 = 0$. Выберем схему интегрирования оценив погрешность при вычислении за один шаг $h$:
1. Метод средних прямоугольников: $|\frac{0.86^3}{24}*(-1)|\approx0.026 > \epsilon = 0.01$
2. Метод трапеций: $|\frac{0.86^3}{12}*(-1)|\approx0.052 > \epsilon = 0.01$
3. Метод Симпсона: $\frac{0.86^5}{2880}*1\approx0.00016 < \epsilon = 0.01$ **Подходит**

Будем использовать метод Симпсона (парабол), тогда $$\int_{-0.09}^{0.77} \cos(x) dx \approx \frac{0.86}{6} * (\cos(-0.09) + \cos(0.77) + 4\cos(\frac{-0.09+0.77}{2})) \approx 0.786$$
Абсолютная погрешность: $$|\frac{0.86}{6} * (\cos(-0.09) + \cos(0.77) + 4\cos(\frac{-0.09+0.77}{2})) - \int_{-0.09}^{0.77} \cos(x) dx| =$$ 
$$= 0.786166 - 0.786014 \approx 0.00016 < \epsilon$$
### Задание 3: Использование DeepSeek для решения предыдущей задачи
*Промт*: Оптимальный метод численного интегрирования Int{cos(x)}dx x in [-0.09,0.77] с точностью 0.01?
#### Ответ DeepSeek:
Нам нужно вычислить интеграл: $I = \int_{-0.09}^{0.77} \cos(x) \, dx$ с точностью **0.01**.
#### 1. Аналитическое решение (для сравнения)

Сначала найдем точное значение, чтобы понимать, к чему стремиться.
$$I = \int \cos(x) \, dx = \sin(x) + C$$
$$I_{\text{точн}} = \sin(0.77) - \sin(-0.09) = \sin(0.77) + \sin(0.09)$$
Вычисляем:
* $\sin(0.77) \approx 0.696135$ (можно взять более точное значение 0.696135...)
* $\sin(0.09) \approx 0.089879$ (можно взять более точное значение 0.089879...)

$I_{\text{точн}} \approx 0.696135 + 0.089879 = 0.786014$

**Наша цель:** найти численный метод, который даст результат в диапазоне **от 0.776 до 0.796**.

---

#### 2. Анализ задачи для выбора метода

*   **Подынтегральная функция:** `f(x) = cos(x)`
*   **Поведение функции:** На интервале $[-0.09, 0.77]$ косинус является гладкой, непрерывной функцией без особенностей. Его вторая и четвертая производные также ограничены.
*   **Длина интервала:** $b - a = 0.77 - (-0.09) = 0.86$. Интервал довольно мал.
*   **Требуемая точность:** $\epsilon = 0.01$ — не самая высокая.

**Вывод:** Из-за малой длины интервала и гладкости функции даже простые методы будут сходиться очень быстро. Сложные методы типа Гаусса или Ромберга здесь избыточны.

---

#### 3. Оценка методов и шага интегрирования

Давайте оценим, сколько шагов (участков разбиения) потребуется простейшим методам.

#### Формула трапеций
Погрешность для формулы трапеций оценивается как:
$$E_T \approx -\frac{(b-a)^3}{12 N^2} f''(\xi)$$
где $f''(x) = -\cos(x)$, следовательно, $|f''(x)| \leq 1$.
$$|E_T| \lessapprox \frac{(0.86)^3}{12 N^2} \cdot 1 = \frac{0.636}{12 N^2} \approx \frac{0.053}{N^2}$$
Нам нужно, чтобы $|E_T| < 0.01$:
$$\frac{0.053}{N^2} < 0.01 \implies N^2 > 5.3 \implies N > 2.3$$
Уже при **N=3** погрешность должна быть меньше 0.01.

#### Формула Симпсона (парабол)
Погрешность для формулы Симпсона оценивается как:
$$E_S \approx -\frac{(b-a)^5}{2880 N^4} f^{(4)}(\xi)$$
где $f^{(4)}(x) = \cos(x)$, следовательно, $|f^{(4)}(x)| \leq 1$.
$$|E_S| \lessapprox \frac{(0.86)^5}{2880 N^4} \cdot 1 = \frac{0.474}{2880 N^4} \approx \frac{0.000165}{N^4}$$
Нам нужно, чтобы $|E_S| < 0.01$:
$$\frac{0.000165}{N^4} < 0.01 \implies N^4 > 0.0165 \implies N > 0.36$$
Это означает, что даже **N=2** (один двойной шаг) будет более чем достаточен.

---

#### 4. Проверка расчетом

Давайте вычислим интеграл для N=2 (один двойной шаг для Симпсона, т.е. три узла).

*   $a = -0.09$, $b = 0.77$, $N=2$
*   Шаг $h = \frac{0.86}{2} = 0.43$
*   Узлы:
    * $x_0 = -0.09$
    * $x_1 = -0.09 + 0.43 = 0.34$
    * $x_2 = -0.09 + 0.86 = 0.77$

**Формула Симпсона:**
$$I_S = \frac{h}{3}[f(x_0) + 4f(x_1) + f(x_2)]$$
$$I_S = \frac{0.43}{3}[\cos(-0.09) + 4\cos(0.34) + \cos(0.77)]$$
Вычисляем значения:
* $\cos(-0.09) = \cos(0.09) \approx 0.995953$
* $\cos(0.34) \approx 0.942755$
* $\cos(0.77) \approx 0.717964$

Подставляем:
$$I_S = \frac{0.43}{3}[0.995953 + 4 \cdot 0.942755 + 0.717964]$$
$$I_S = \frac{0.43}{3}[0.995953 + 3.77102 + 0.717964] = \frac{0.43}{3}[5.484937]$$
$$I_S \approx \frac{0.43 \cdot 5.484937}{3} \approx \frac{2.358523}{3} \approx 0.786174$$

**Сравнение с точным значением (0.786014):**
Погрешность составляет $|0.786174 - 0.786014| = 0.00016$, что **на два порядка лучше** требуемой точности 0.01.

---

#### 5. Заключение и оптимальный метод

**Оптимальным методом** для данной задачи является **метод Симпсона (формула парабол)** с **N=2** (всего три вычисления функции).

**Обоснование:**
1.  **Простота:** Расчет по одной формуле с тремя узлами.
2.  **Скорость:** Требуется всего три вычисления косинуса.
3.  **Точность:** Значительно превосходит требуемую (погрешность ~0.00016 против требуемых 0.01).
4.  **Избыточность других методов:**
    *   Метод прямоугольников или трапеций потребовал бы большего числа узлов для достижения такой же точности.
    *   Методы更高阶 (например, Гаусса) дадут сопоставимую точность, но формула Симпсона для этого случая является стандартным и оптимальным выбором.

**Ответ:** Для интегрирования $\int_{-0.09}^{0.77} \cos(x) \, dx$ с точностью 0.01 оптимально использовать **метод Симпсона с 2 интервалами (3 узлами)**.
### Задание 3: Анализ ответа DeepSeek:
В первую очередь модель оценила погрешность на отрезке более простого метода трапеций, после чего оценила метод Симпсона. Увидев подходящую погрешность она посчитала этот метод наиболее оптимальным. Затем она вычислила приближенное значение интеграла и оценила абсолютную погрешность с аналитическим решением.  

**Вывод:** За исключением использования китайских иероглифов в 4 пункте обоснования ответа, меня удовлетворил ответ DeepSeek. Возможно, модели просто повезло дать правильный ответ для решения моего варианта задания, а может быть, другие студенты, которые уже выполнили это практическое задание, своими запросами обучили DeepSeek не допускать явных недостатков в решении подобной задачи.

### Задания 4-5: Вычисление сложного интеграла
#### Выбор функции
Пусть $\psi(x)=x^3$, тогда интеграл имеет вид: $\int_{-\infty}^{\infty}\psi(x)e^{-x^2}dx$. Такой интеграл можно вычислить квадратурами Гаусса-Эрмита. Квадратурная формула Гаусса-Эрмита с $N$ узлами точна для многочленов $\psi(x)$ степени до $2N − 1$ включительно. В моем случае $N = 3$, следовательно, формула точна для многочленов степени до 5. Поскольку выбранная функция $\psi(x) = x^3$ является многочленом 3-й степени, и $3 \leq 5$, остаточный член теоретически равен нулю. Ожидаемая абсолютная погрешность $\Delta = 0$.
#### Расчет узлов
Узлы квадратуры $x_i$ являются корнями полинома Эрмита соответствующей степени, в нашем случае $H_3(x)$. Полиномы Эрмита определяются рекуррентно: $$H_{n+1}(x) = 2xH_n(x) − 2nH_{n−1}(x)$$, где $H_0(x) = 1, H_1(x) = 2x$.
$$H_2(x)=2xH_1(x)-2H_0(x)=2x(2x)-2(1)=4x^2-2$$
$$H_3(x)=2xH_2(x)-2*2H_1(x)=2x(4x^2-2)-4(2x)=8x63-12x$$
$$8x^3-12x=0 => 4x(2x^2-3)=0$$
Отсюда корни уравнения:
$$x_2 = 0, x_1, x_3 = \pm \sqrt{1.5}\approx \pm 1.2247$$
#### Расчет коэффициентов
Коэффициенты квадратурной формулы определяются как $$\alpha_i=\int_a^b\rho(x)l_i(x)dx$$
где $l_i(x)$ - базисный полином Лагранжа.
$$l_1(x)=\frac{(x-x_2)(x-x_3)}{(x_1-x_2)(x_1-x_3)}=\frac{x(x-\sqrt{1.5})}{-\sqrt{1.5}(-2\sqrt{1.5})}=\frac{x^2-\sqrt{1.5}x}{3}$$
$$\alpha_1=\frac{1}{3}\int_{\infty}^{\infty}x^2e^{-x^2}dx-\frac{\sqrt{1.5}}{3}\int_{\infty}^{\infty}xe^{-x^2}dx=\frac{1}{3}*\frac{\sqrt{\pi}}{2}-0=\frac{\sqrt{\pi}}{6}\approx0.2954$$

$$l_2(x)=\frac{(x-x_1)(x-x_3)}{(x_2-x_1)(x_2-x_3)}=\frac{(x+\sqrt{1.5})(x-\sqrt{1.5})}{(0+\sqrt{1.5})(0-\sqrt{1.5})}=\frac{x^2-1.5}{-1.5}=1-\frac{2}{3}x^2$$
$$\alpha_2=\int_{\infty}^{\infty}(1-\frac{2}{3}x^2)e^{-x^2}dx=\sqrt{\pi}-\frac{2}{3}\frac{\sqrt{\pi}}{2}=\frac{2\sqrt{\pi}}{3}\approx1.1816$$

$$l_3(x)=\frac{(x-x_2)(x-x_1)}{(x_3-x_2)(x_3-x_2)}=\frac{x(x-\sqrt{1.5})}{-\sqrt{1.5}(-2\sqrt{1.5})}=\frac{x^2-\sqrt{1.5}x}{3}$$
$$\alpha_3=\frac{1}{3}\int_{\infty}^{\infty}x^2e^{-x^2}dx-\frac{\sqrt{1.5}}{3}\int_{\infty}^{\infty}xe^{-x^2}dx=\frac{1}{3}*\frac{\sqrt{\pi}}{2}-0=\frac{\sqrt{\pi}}{6}\approx0.2954$$
#### Вычисление интеграла
$$I\approx \sum_{i=1}^3\alpha_i \psi(x_i)=0.2954*(-1.2247)^3+1.1816*0 + 0.2954*(1.2247)^3=0.0$$
Аналитически $\int_{-\infty}^{\infty}x^3e^{-x^2}dx=0$ из-за нечетности подынтегральной функции.

Абсолютная погрешность $\Delta = 0 - 0 = 0$

### Вывод
В ходе выполнения работы я сформировал практические навыки применения схем численного интегрирования при использовании квадратурных формул интерполяционного типа, квадратур Гаусса и квадратур для вычисления интегралов специального вида.